SELECT  DISTINCT A.MEM_KEY, ELGBLTY_STRT_DT, 
ELGBLTY_TERM_DT  FROM EDW.MEM A,
RPTNG.MMP_MEM_CNTNS_SPAN B
WHERE A.mem_mcaid_id = B.mem_mcaid_id
AND MEM_KEY = '2087393';

SELECT * FROM EDW.MEM WHERE MEM_MCAID_ID = '0002646093';
SELECT * FROM RPTNG.MEM_CNTNS_ELGBLTY B;

---MISSING MEM_MCAID_ID;
select * from RPTNG.MEM_CNTNS_ELGBLTY;
select * from RPTNG.MMP_MEM_CNTNS_SPAN;
0009830194

select * from (
SELECT  DISTINCT A.MEM_KEY, ELGBLTY_STRT_DT, 
ELGBLTY_TERM_DT  FROM EDW.MEM A,
RPTNG.MMP_MEM_CNTNS_SPAN B
WHERE A.mem_mcaid_id = B.mem_mcaid_id
AND MEM_KEY = '2087393';

select * from (
SELECT  DISTINCT A.MEM_KEY, a.MEM_MCAID_ID, ELGBLTY_STRT_DT, 
ELGBLTY_TERM_DT
,ROW_NUMBER() OVER (PARTITION BY MEM_KEY ORDER BY ELGBLTY_STRT_DT DESC) RN 
FROM EDW.MEM A,
RPTNG.MMP_MEM_CNTNS_SPAN B
WHERE A.mem_mcaid_id = B.mem_mcaid_id
and a.MEM_MCAID_ID in 
(
'0002571081',
'0002500310',
'0002413206',
'0001297045',
'0001428320'
)) where rn = 1
;

select DISTINCT B.MEM_KEY, C.MEM_MCAID_ID, C.ELGBLTY_STRT_DT, 
C.ELGBLTY_TERM_DT
,ROW_NUMBER() OVER (PARTITION BY B.MEM_KEY ORDER BY C.ELGBLTY_STRT_DT DESC) RN  
from 
RPTNG.MEM_CNTNS_ELGBLTY A,
EDW.MEM B,
RPTNG.MMP_MEM_CNTNS_SPAN C
WHERE A.MEM_KEY = B.MEM_KEY
AND B.DW_CUR_IND = 'Y' AND B.DW_LGCL_DEL_IND = 'N'
AND B.MEM_MCAID_ID = C.MEM_MCAID_ID
AND C.MEM_MCAID_ID IN
(
'0002571081',
'0002500310',
'0002413206',
'0001297045',
'0001428320'
);

SELECT * FROM EDW.MEM B
WHERE MEM_KEY IN ('2092435',
'2085206',
'2087389',
'2100413',
'2087444');
